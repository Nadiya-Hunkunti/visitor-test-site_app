<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Visitor Tracking Test Website</title>
</head>
<body>

    <h1>Welcome to Visitor Tracking Demo</h1>
    <p>
        This is a test website.  
        Stay on this page for 20â€“30 seconds, then close the tab.
    </p>

    <!-- ðŸ”½ VISITOR TRACKING WITH LOCATION (ACCURATE & CONSENT-BASED) -->
   <script>
let visitId = null;

if ("geolocation" in navigator) {
  navigator.geolocation.getCurrentPosition(
    (position) => {
      fetch("https://visitor-tracker-4dcw.onrender.com/track/start", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          page: window.location.href,
          lat: position.coords.latitude,
          lon: position.coords.longitude
        })
      })
      .then(res => res.json())
      .then(data => visitId = data.visit_id);
    },
    (error) => {
      console.log("Location denied");
    }
  );
}

window.addEventListener("beforeunload", () => {
  if (visitId) {
    navigator.sendBeacon(
      "https://visitor-tracker-4dcw.onrender.com/track/end",
      JSON.stringify({ visit_id: visitId })
    );
  }
});
</script>






